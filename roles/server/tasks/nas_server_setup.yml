- name: install nfs server package
  package:
    name: nfs-kernel-server
    state: latest

- name: create export directory
  file:
    path: /data
    state: directory

- name: copy exports to /etc/exports
  template:
    src: exports
    dest: /etc/exports

- name: reload nfs exports
  command: exportfs -a

- name: restart nfs server service
  systemd:
    name: nfs-kernel-server
    state: restarted

- name: install samba
  package:
    name: samba
    state: latest

- name: add block to config file
  blockinfile:
    path: /etc/samba/smb.conf
    block: |
      [public]
         path = /data/public
         browsable = yes
         read only = no
         guest ok = yes

- name: add block to config file
  blockinfile:
    path: /etc/samba/smb.conf
    block: |
      [johannes]
         path = /data/johannes
         browsable = yes
         read only = no
         guest ok = no
         vaild users = jogi
